<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introductory Econometrics Examples • wooldridge</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introductory Econometrics Examples">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wooldridge</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introductory-Econometrics-Examples.html">Introductory Econometrics Examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introductory Econometrics Examples</h1>
                        <h4 class="author">Justin M Shea</h4>
            
      
      
      <div class="hidden name"><code>Introductory-Econometrics-Examples.Rmd</code></div>

    </div>

    
    

<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette contains examples from every chapter of <em>Introductory Econometrics: A Modern Approach, 6e</em> by Jeffrey M. Wooldridge. Each example illustrates how to load data, build econometric models, and compute estimates with <strong>R</strong>.</p>
<p>In addition, the <strong>Appendix</strong> cites good sources on using <strong>R</strong> for econometrics.</p>
<p>Now, install and load the <code>wooldridge</code> package and lets get started!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"wooldridge"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(wooldridge)</code></pre></div>

</div>
<div id="chapter-2-the-simple-regression-model" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-2-the-simple-regression-model" class="anchor"></a>Chapter 2: The Simple Regression Model</h2>
<div id="example-2-10-a-log-wage-equation" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2-10-a-log-wage-equation" class="anchor"></a><strong><code>Example 2.10:</code> A Log Wage Equation</strong>
</h3>
<p>Load the <code>wage1</code> data and check out the documentation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"wage1"</span>)

?wage1</code></pre></div>
<p>The documentation indicates these are data from the 1976 Current Population Survey, collected by Henry Farber when he and Wooldridge were colleagues at MIT in 1988.</p>
<p><strong><span class="math inline">\(wage\)</span>:</strong> average hourly earnings</p>
<p><strong><span class="math inline">\(educ\)</span>:</strong> years of education</p>
<p>First, make a scatter-plot of the two variables and look for possible patterns in the relationship between them.</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>It appears that <em><strong>on average</strong></em>, more years of education, leads to higher wages.</p>
<p>The example in the text investigates what the <em><strong>percentage</strong></em> change between wages and education might be. So, we must use the <span class="math inline">\(log(\)</span><code>wage</code><span class="math inline">\()\)</span>.</p>
<p>Build a linear model to estimate the relationship between the <em>log of wage</em> (<code>lwage</code>) and <em>education</em> (<code>educ</code>).</p>
<p><span class="math display">\[\widehat{log(wage)} = \beta_0 + \beta_1educ\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log_wage_model &lt;-<span class="st"> </span><span class="kw">lm</span>(lwage <span class="op">~</span><span class="st"> </span>educ, <span class="dt">data =</span> wage1)</code></pre></div>
<p>Print the <code>summary</code> of the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(log_wage_model)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lwage
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
educ
</td>
<td>
0.08274<sup>***</sup> (0.00757)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.58377<sup>***</sup> (0.09734)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
526
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.18581
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.18425
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.48008 (df = 524)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
119.58160<sup>***</sup> (df = 1; 524)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Plot the <span class="math inline">\(log(\)</span><code>wage</code><span class="math inline">\()\)</span> vs <code>educ</code>, adding a line representing the least squares fit.</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>

</div>
</div>
<div id="chapter-3-multiple-regression-analysis-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-3-multiple-regression-analysis-estimation" class="anchor"></a>Chapter 3: Multiple Regression Analysis: Estimation</h2>
<div id="example-3-2-hourly-wage-equation" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3-2-hourly-wage-equation" class="anchor"></a><strong><code>Example 3.2:</code> Hourly Wage Equation</strong>
</h3>
<p>Check the documentation for variable information</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><a href="../reference/wage1.html">?wage1</a></code></pre></div>
<p><strong><span class="math inline">\(lwage\)</span>:</strong> log of the average hourly earnings</p>
<p><strong><span class="math inline">\(educ\)</span>:</strong> years of education</p>
<p><strong><span class="math inline">\(exper\)</span>:</strong> years of potential experience</p>
<p><strong><span class="math inline">\(tenutre\)</span>:</strong> years with current employer</p>
<p>Plot the variables against <code>lwage</code> and compare their distributions and slope (<span class="math inline">\(\beta\)</span>) of the simple regression lines.</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Estimate the model regressing <em>educ</em>, <em>exper</em>, and <em>tenure</em> against <em>log(wage)</em>.</p>
<p><span class="math display">\[\widehat{log(wage)} = \beta_0 + \beta_1educ + \beta_3exper + \beta_4tenure\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hourly_wage_model &lt;-<span class="st"> </span><span class="kw">lm</span>(lwage <span class="op">~</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>exper <span class="op">+</span><span class="st"> </span>tenure, <span class="dt">data =</span> wage1)</code></pre></div>
<p>Print the estimated model coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coefficients</span>(hourly_wage_model)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">Coefficients</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="left">0.2844</td>
</tr>
<tr class="even">
<td>educ</td>
<td align="left">0.0920</td>
</tr>
<tr class="odd">
<td>exper</td>
<td align="left">0.0041</td>
</tr>
<tr class="even">
<td>tenure</td>
<td align="left">0.0221</td>
</tr>
</tbody>
</table>
<p>Plot the coefficients, representing percentage impact of each variable on <span class="math inline">\(log(\)</span><code>wage</code><span class="math inline">\()\)</span> for a quick comparison.</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div id="chapter-4-multiple-regression-analysis-inference" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-4-multiple-regression-analysis-inference" class="anchor"></a>Chapter 4: Multiple Regression Analysis: Inference</h2>
<div id="example-4-1-hourly-wage-equation" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4-1-hourly-wage-equation" class="anchor"></a><strong><code>Example 4.1</code> Hourly Wage Equation</strong>
</h3>
<p>Using the same model estimated in <strong><code>example: 3.2</code></strong>, examine and compare the standard errors associated with each coefficient. Like the textbook, these are contained in parenthesis next to each associated coefficient.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(hourly_wage_model)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lwage
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
educ
</td>
<td>
0.09203<sup>***</sup> (0.00733)
</td>
</tr>
<tr>
<td style="text-align:left">
exper
</td>
<td>
0.00412<sup>**</sup> (0.00172)
</td>
</tr>
<tr>
<td style="text-align:left">
tenure
</td>
<td>
0.02207<sup>***</sup> (0.00309)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.28436<sup>***</sup> (0.10419)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
526
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.31601
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.31208
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.44086 (df = 522)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
80.39092<sup>***</sup> (df = 3; 522)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>For the years of experience variable, or <code>exper</code>, use coefficient and Standard Error to compute the <span class="math inline">\(t\)</span> statistic:</p>
<p><span class="math display">\[t_{exper} = \frac{0.004121}{0.001723} = 2.391\]</span></p>
<p>Fortunately, <code>R</code> includes <span class="math inline">\(t\)</span> statistics in the <code>summary</code> of model diagnostics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(hourly_wage_model)<span class="op">$</span>coefficients</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">Estimate</th>
<th align="left">Std. Error</th>
<th align="left">t value</th>
<th align="left">Pr(&gt;|t|)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="left">0.28436</td>
<td align="left">0.10419</td>
<td align="left">2.72923</td>
<td align="left">0.00656</td>
</tr>
<tr class="even">
<td>educ</td>
<td align="left">0.09203</td>
<td align="left">0.00733</td>
<td align="left">12.55525</td>
<td align="left">0.00000</td>
</tr>
<tr class="odd">
<td>exper</td>
<td align="left">0.00412</td>
<td align="left">0.00172</td>
<td align="left">2.39144</td>
<td align="left">0.01714</td>
</tr>
<tr class="even">
<td>tenure</td>
<td align="left">0.02207</td>
<td align="left">0.00309</td>
<td align="left">7.13307</td>
<td align="left">0.00000</td>
</tr>
</tbody>
</table>
<p>Plot the <span class="math inline">\(t\)</span> statistics for a visual comparison:</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div id="example-4-7-effect-of-job-training-on-firm-scrap-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4-7-effect-of-job-training-on-firm-scrap-rates" class="anchor"></a><strong><code>Example 4.7</code> Effect of Job Training on Firm Scrap Rates</strong>
</h3>
<p>Load the <code>jtrain</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"jtrain"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><a href="../reference/jtrain.html">?jtrain</a></code></pre></div>
<p>From H. Holzer, R. Block, M. Cheatham, and J. Knott (1993), <em>Are Training Subsidies Effective? The Michigan Experience</em>, Industrial and Labor Relations Review 46, 625-636. The authors kindly provided the data.</p>
<p><strong><span class="math inline">\(year:\)</span></strong> 1987, 1988, or 1989</p>
<p><strong><span class="math inline">\(union:\)</span></strong> =1 if unionized</p>
<p><strong><span class="math inline">\(lscrap:\)</span></strong> Log(scrap rate per 100 items)</p>
<p><strong><span class="math inline">\(hrsemp:\)</span></strong> (total hours training) / (total employees trained)</p>
<p><strong><span class="math inline">\(lsales:\)</span></strong> Log(annual sales, $)</p>
<p><strong><span class="math inline">\(lemploy:\)</span></strong> Log(umber of employees at plant)</p>
<p>First, use the <code>subset</code> function and it’s argument by the same name to return observations which occurred in <strong>1987</strong> and are not <strong>union</strong>. At the same time, use the <code>select</code> argument to return only the variables of interest for this problem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">jtrain_subset &lt;-<span class="st"> </span><span class="kw">subset</span>(jtrain, <span class="dt">subset =</span> (year <span class="op">==</span><span class="st"> </span><span class="dv">1987</span> <span class="op">&amp;</span><span class="st"> </span>union <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
                          <span class="dt">select =</span> <span class="kw">c</span>(year, union, lscrap, hrsemp, lsales, lemploy))</code></pre></div>
<p>Next, test for missing values. One can “eyeball” these with R Studio’s <code>View</code> function, but a more precise approach combines the <code>sum</code> and <code>is.na</code> functions to return the total number of observations equal to <code>NA</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">is.na</span>(jtrain_subset))</code></pre></div>
<pre><code>## [1] 156</code></pre>
<p>While <code>R</code>’s <code>lm</code> function will automatically remove missing <code>NA</code> values, eliminating these manually will produce more clearly proportioned graphs for exploratory analysis. Call the <code>na.omit</code> function to remove all missing values and assign the new <code>data.frame</code> object the name <strong><code>jtrain_clean</code></strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">jtrain_clean &lt;-<span class="st"> </span><span class="kw">na.omit</span>(jtrain_subset)</code></pre></div>
<p>Use <code>jtrain_clean</code> to plot the variables of interest against <code>lscrap</code>. Visually observe the respective distributions for each variable, and compare the slope (<span class="math inline">\(\beta\)</span>) of the simple regression lines.</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>Now create the linear model regressing <code>hrsemp</code>(total hours training/total employees trained), the <code>lsales</code>(log of annual sales), and <code>lemploy</code>(the log of the number of the employees), against <code>lscrap</code>(the log of the scrape rate).</p>
<p><span class="math display">\[lscrap = \alpha + \beta_1 hrsemp + \beta_2 lsales + \beta_3 lemploy\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linear_model &lt;-<span class="st"> </span><span class="kw">lm</span>(lscrap <span class="op">~</span><span class="st"> </span>hrsemp <span class="op">+</span><span class="st"> </span>lsales <span class="op">+</span><span class="st"> </span>lemploy, <span class="dt">data =</span> jtrain_clean)</code></pre></div>
<p>Finally, print the complete summary diagnostics of the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(linear_model)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lscrap
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
hrsemp
</td>
<td>
-0.02927 (0.02280)
</td>
</tr>
<tr>
<td style="text-align:left">
lsales
</td>
<td>
-0.96203<sup>**</sup> (0.45252)
</td>
</tr>
<tr>
<td style="text-align:left">
lemploy
</td>
<td>
0.76147<sup>*</sup> (0.40743)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
12.45837<sup>**</sup> (5.68677)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
29
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.26243
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.17392
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.37604 (df = 25)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
2.96504<sup>*</sup> (df = 3; 25)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-5-multiple-regression-analysis-ols-asymptotics" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-5-multiple-regression-analysis-ols-asymptotics" class="anchor"></a>Chapter 5: Multiple Regression Analysis: OLS Asymptotics</h2>
<div id="example-5-1-housing-prices-and-distance-from-an-incinerator" class="section level3">
<h3 class="hasAnchor">
<a href="#example-5-1-housing-prices-and-distance-from-an-incinerator" class="anchor"></a><strong><code>Example 5.1:</code> Housing Prices and Distance From an Incinerator</strong>
</h3>
<p>Load the <code>hprice3</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"hprice3"</span>)</code></pre></div>
<p><strong><span class="math inline">\(lprice:\)</span></strong> Log(selling price)</p>
<p><strong><span class="math inline">\(ldist:\)</span></strong> Log(distance from house to incinerator, feet)</p>
<p><strong><span class="math inline">\(larea:\)</span></strong> Log(square footage of house)</p>
<p>Graph the prices of housing against distance from an incinerator:</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-33-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Next, model the <span class="math inline">\(log(\)</span><code>price</code><span class="math inline">\()\)</span> against the <span class="math inline">\(log(\)</span><code>dist</code><span class="math inline">\()\)</span> to estimate the percentage relationship between the two.</p>
<p><span class="math display">\[price = \alpha + \beta_1 dist\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">price_dist_model &lt;-<span class="st"> </span><span class="kw">lm</span>(lprice <span class="op">~</span><span class="st"> </span>ldist, <span class="dt">data =</span> hprice3)</code></pre></div>
<p>Create another model that controls for “quality” variables, such as square footage <code>area</code> per house.</p>
<p><span class="math display">\[price = \alpha + \beta_1 dist + \beta_2 area\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">price_area_model &lt;-<span class="st"> </span><span class="kw">lm</span>(lprice <span class="op">~</span><span class="st"> </span>ldist <span class="op">+</span><span class="st"> </span>larea, <span class="dt">data =</span> hprice3)</code></pre></div>
<p>Compare the coefficients of both models. Notice that adding <code>area</code> improves the quality of the model, but also reduces the coefficient size of <code>dist</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(price_dist_model)
<span class="kw">summary</span>(price_area_model)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
lprice
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
ldist
</td>
<td>
0.31722<sup>***</sup> (0.04811)
</td>
<td>
0.19623<sup>***</sup> (0.03816)
</td>
</tr>
<tr>
<td style="text-align:left">
larea
</td>
<td>
</td>
<td>
0.78368<sup>***</sup> (0.05358)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
8.25750<sup>***</sup> (0.47383)
</td>
<td>
3.49394<sup>***</sup> (0.49065)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
321
</td>
<td>
321
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.11994
</td>
<td>
0.47385
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.11718
</td>
<td>
0.47054
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.41170 (df = 319)
</td>
<td>
0.31883 (df = 318)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
43.47673<sup>***</sup> (df = 1; 319)
</td>
<td>
143.19470<sup>***</sup> (df = 2; 318)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Graphing illustrates the larger coefficient for <code>area</code>.</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>

</div>
</div>
<div id="chapter-6-multiple-regression-further-issues" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-6-multiple-regression-further-issues" class="anchor"></a>Chapter 6: Multiple Regression: Further Issues</h2>
<div id="example-6-1-effects-of-pollution-on-housing-prices-standardized-" class="section level3">
<h3 class="hasAnchor">
<a href="#example-6-1-effects-of-pollution-on-housing-prices-standardized-" class="anchor"></a><strong><code>Example 6.1:</code> Effects of Pollution on Housing Prices, standardized.</strong>
</h3>
<p>Load the <code>hprice2</code> data and view the documentation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"hprice2"</span>)
?hprice2</code></pre></div>
<p>Data from <em>Hedonic Housing Prices and the Demand for Clean Air</em>, by Harrison, D. and D.L.Rubinfeld, Journal of Environmental Economics and Management 5, 81-102. Diego Garcia, a former Ph.D. student in economics at MIT, kindly provided these data, which he obtained from the book Regression Diagnostics: Identifying Influential Data and Sources of Collinearity, by D.A. Belsey, E. Kuh, and R. Welsch, 1990. New York: Wiley.</p>
<p><span class="math inline">\(price\)</span>: median housing price.</p>
<p><span class="math inline">\(nox\)</span>: Nitrous Oxide concentration; parts per million.</p>
<p><span class="math inline">\(crime\)</span>: number of reported crimes per capita.</p>
<p><span class="math inline">\(rooms\)</span>: average number of rooms in houses in the community.</p>
<p><span class="math inline">\(dist\)</span>: weighted distance of the community to 5 employment centers.</p>
<p><span class="math inline">\(stratio\)</span>: average student-teacher ratio of schools in the community.</p>
<p><span class="math display">\[price = \beta_0 + \beta_1nox + \beta_2crime + \beta_3rooms + \beta_4dist + \beta_5stratio + \mu\]</span></p>
<p>Estimate the usual <code>lm</code> model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">housing_level &lt;-<span class="st"> </span><span class="kw">lm</span>(price <span class="op">~</span><span class="st"> </span>nox <span class="op">+</span><span class="st"> </span>crime <span class="op">+</span><span class="st"> </span>rooms <span class="op">+</span><span class="st"> </span>dist <span class="op">+</span><span class="st"> </span>stratio, <span class="dt">data =</span> hprice2)</code></pre></div>
<p>Estimate the same model, but standardized coefficients by wrapping each variable with R’s <code>scale</code> function:</p>
<p><span class="math display">\[\widehat{zprice} = \beta_1znox + \beta_2zcrime + \beta_3zrooms + \beta_4zdist + \beta_5zstratio\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">housing_standardized &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">scale</span>(price) <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(nox) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(crime) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(rooms) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(dist) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(stratio), <span class="dt">data =</span> hprice2)</code></pre></div>
<p>Compare results, and observe</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(housing_level)
<span class="kw">summary</span>(housing_standardized)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
price
</td>
<td>
scale(price)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
nox
</td>
<td>
-2,706.43300<sup>***</sup> (354.08690)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
crime
</td>
<td>
-153.60100<sup>***</sup> (32.92883)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
rooms
</td>
<td>
6,735.49800<sup>***</sup> (393.60370)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
dist
</td>
<td>
-1,026.80600<sup>***</sup> (188.10790)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
stratio
</td>
<td>
-1,149.20400<sup>***</sup> (127.42870)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
scale(nox)
</td>
<td>
</td>
<td>
-0.34045<sup>***</sup> (0.04450)
</td>
</tr>
<tr>
<td style="text-align:left">
scale(crime)
</td>
<td>
</td>
<td>
-0.14328<sup>***</sup> (0.03069)
</td>
</tr>
<tr>
<td style="text-align:left">
scale(rooms)
</td>
<td>
</td>
<td>
0.51389<sup>***</sup> (0.03000)
</td>
</tr>
<tr>
<td style="text-align:left">
scale(dist)
</td>
<td>
</td>
<td>
-0.23484<sup>***</sup> (0.04298)
</td>
</tr>
<tr>
<td style="text-align:left">
scale(stratio)
</td>
<td>
</td>
<td>
-0.27028<sup>***</sup> (0.02994)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
20,871.13000<sup>***</sup> (5,054.59900)
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
506
</td>
<td>
506
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.63567
</td>
<td>
0.63567
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.63202
</td>
<td>
0.63203
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
5,586.19800 (df = 500)
</td>
<td>
0.60601 (df = 501)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
174.47330<sup>***</sup> (df = 5; 500)
</td>
<td>
174.82220<sup>***</sup> (df = 5; 501)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<div id="example-6-2-effects-of-pollution-on-housing-prices-quadratic-interactive-term" class="section level3">
<h3 class="hasAnchor">
<a href="#example-6-2-effects-of-pollution-on-housing-prices-quadratic-interactive-term" class="anchor"></a><strong><code>Example 6.2:</code> Effects of Pollution on Housing Prices, Quadratic Interactive Term</strong>
</h3>
<p>Modify the housing model from <strong><code>example 4.5</code></strong>, adding a quadratic term in <em>rooms</em>:</p>
<p><span class="math display">\[log(price) = \beta_0 + \beta_1log(nox) + \beta_2log(dist) + \beta_3rooms + \beta_4rooms^2 + \beta_5stratio + \mu\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">housing_model_<span class="fl">4.5</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(lprice <span class="op">~</span><span class="st"> </span>lnox <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(dist) <span class="op">+</span><span class="st"> </span>rooms <span class="op">+</span><span class="st"> </span>stratio, <span class="dt">data =</span> hprice2)

housing_model_<span class="fl">6.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(lprice <span class="op">~</span><span class="st"> </span>lnox <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(dist) <span class="op">+</span><span class="st"> </span>rooms <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(rooms<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>stratio, 
                        <span class="dt">data =</span> hprice2)</code></pre></div>
<p>Compare the results with the model from <code>example 6.1</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(housing_model_<span class="fl">4.5</span>)
<span class="kw">summary</span>(housing_model_<span class="fl">6.2</span>)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
lprice
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
lnox
</td>
<td>
-0.95354<sup>***</sup> (0.11674)
</td>
<td>
-0.90168<sup>***</sup> (0.11469)
</td>
</tr>
<tr>
<td style="text-align:left">
log(dist)
</td>
<td>
-0.13434<sup>***</sup> (0.04310)
</td>
<td>
-0.08678<sup>**</sup> (0.04328)
</td>
</tr>
<tr>
<td style="text-align:left">
rooms
</td>
<td>
0.25453<sup>***</sup> (0.01853)
</td>
<td>
-0.54511<sup>***</sup> (0.16545)
</td>
</tr>
<tr>
<td style="text-align:left">
I(rooms2)
</td>
<td>
</td>
<td>
0.06226<sup>***</sup> (0.01280)
</td>
</tr>
<tr>
<td style="text-align:left">
stratio
</td>
<td>
-0.05245<sup>***</sup> (0.00590)
</td>
<td>
-0.04759<sup>***</sup> (0.00585)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
11.08386<sup>***</sup> (0.31811)
</td>
<td>
13.38548<sup>***</sup> (0.56647)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
506
</td>
<td>
506
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.58403
</td>
<td>
0.60281
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.58071
</td>
<td>
0.59884
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.26500 (df = 501)
</td>
<td>
0.25921 (df = 500)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
175.85520<sup>***</sup> (df = 4; 501)
</td>
<td>
151.77040<sup>***</sup> (df = 5; 500)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Estimate the minimum turning point at which the <code>rooms</code> interactive term changes from negative to positive.</p>
<p><span class="math display">\[x = \frac{\hat{\beta_1}}{2\hat{\beta_2}}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beta_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">summary</span>(housing_model_<span class="fl">6.2</span>)<span class="op">$</span>coefficients[<span class="st">"rooms"</span>,<span class="dv">1</span>] 
beta_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">summary</span>(housing_model_<span class="fl">6.2</span>)<span class="op">$</span>coefficients[<span class="st">"I(rooms^2)"</span>,<span class="dv">1</span>]
turning_point &lt;-<span class="st"> </span><span class="kw">abs</span>(beta_<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>beta_<span class="dv">2</span>))

<span class="kw">print</span>(turning_point)</code></pre></div>
<pre><code>## [1] 4.37763</code></pre>
<p>Compute the percent change across a range of average rooms. Include the smallest, turning point, and largest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Rooms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(hprice2<span class="op">$</span>rooms), <span class="dv">4</span>, turning_point, <span class="dv">5</span>, <span class="fl">5.5</span>, <span class="fl">6.45</span>, <span class="fl">7.5</span>, <span class="kw">max</span>(hprice2<span class="op">$</span>rooms))
Percent.Change &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">*</span>(beta_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>beta_<span class="dv">2</span><span class="op">*</span>Rooms)

<span class="kw">kable</span>(<span class="kw">data.frame</span>(Rooms, Percent.Change))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Rooms</th>
<th align="right">Percent.Change</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">3.56000</td>
<td align="right">-10.181324</td>
</tr>
<tr class="even">
<td align="right">4.00000</td>
<td align="right">-4.702338</td>
</tr>
<tr class="odd">
<td align="right">4.37763</td>
<td align="right">0.000000</td>
</tr>
<tr class="even">
<td align="right">5.00000</td>
<td align="right">7.749903</td>
</tr>
<tr class="odd">
<td align="right">5.50000</td>
<td align="right">13.976023</td>
</tr>
<tr class="even">
<td align="right">6.45000</td>
<td align="right">25.805651</td>
</tr>
<tr class="odd">
<td align="right">7.50000</td>
<td align="right">38.880503</td>
</tr>
<tr class="even">
<td align="right">8.78000</td>
<td align="right">54.819367</td>
</tr>
</tbody>
</table>
<p>Graph the log of the selling price against the number of rooms. Superimpose a simple model as well as a quadratic model and examine the difference.</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>

</div>
</div>
<div id="chapter-7-multiple-regression-analysis-with-qualitative-information" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-7-multiple-regression-analysis-with-qualitative-information" class="anchor"></a>Chapter 7: Multiple Regression Analysis with Qualitative Information</h2>
<div id="example-7-4-housing-price-regression-qualitative-binary-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#example-7-4-housing-price-regression-qualitative-binary-variable" class="anchor"></a><strong><code>Example 7.4:</code> Housing Price Regression, Qualitative Binary variable</strong>
</h3>
<p>This time, use the <code>hrprice1</code> data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"hprice1"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><a href="../reference/hprice1.html">?hprice1</a></code></pre></div>
<p>Data collected from the real estate pages of the Boston Globe during 1990. These are homes that sold in the Boston, MA area.</p>
<p><strong><span class="math inline">\(lprice:\)</span></strong> Log(house price, $1000s)</p>
<p><strong><span class="math inline">\(llotsize:\)</span></strong> Log(size of lot in square feet)</p>
<p><strong><span class="math inline">\(lsqrft:\)</span></strong> Log(size of house in square feet)</p>
<p><strong><span class="math inline">\(bdrms:\)</span></strong> number of bdrms</p>
<p><strong><span class="math inline">\(colonial:\)</span></strong> =1 if home is colonial style</p>
<p><span class="math display">\[\widehat{log(price)} = \beta_0 + \beta_1log(lotsize) + \beta_2log(sqrft) + \beta_3bdrms + \beta_4colonial \]</span></p>
<p>Estimate the coefficients of the above linear model on the <code>hprice</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">housing_qualitative &lt;-<span class="st"> </span><span class="kw">lm</span>(lprice <span class="op">~</span><span class="st"> </span>llotsize <span class="op">+</span><span class="st"> </span>lsqrft <span class="op">+</span><span class="st"> </span>bdrms <span class="op">+</span><span class="st"> </span>colonial, <span class="dt">data =</span> hprice1)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(housing_qualitative)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lprice
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
llotsize
</td>
<td>
0.16782<sup>***</sup> (0.03818)
</td>
</tr>
<tr>
<td style="text-align:left">
lsqrft
</td>
<td>
0.70719<sup>***</sup> (0.09280)
</td>
</tr>
<tr>
<td style="text-align:left">
bdrms
</td>
<td>
0.02683 (0.02872)
</td>
</tr>
<tr>
<td style="text-align:left">
colonial
</td>
<td>
0.05380 (0.04477)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-1.34959<sup>**</sup> (0.65104)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
88
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.64907
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.63216
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.18412 (df = 83)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
38.37846<sup>***</sup> (df = 4; 83)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-8-heteroskedasticity" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-8-heteroskedasticity" class="anchor"></a>Chapter 8: Heteroskedasticity</h2>
<div id="example-8-9-determinants-of-personal-computer-ownership" class="section level3">
<h3 class="hasAnchor">
<a href="#example-8-9-determinants-of-personal-computer-ownership" class="anchor"></a><strong><code>Example 8.9:</code> Determinants of Personal Computer Ownership</strong>
</h3>
<p><span class="math display">\[\widehat{PC} = \beta_0 + \beta_1hsGPA + \beta_2ACT + \beta_3parcoll + \beta_4colonial \]</span> Christopher Lemmon, a former MSU undergraduate, collected these data from a survey he took of MSU students in Fall 1994. Load <code>gpa1</code> and create a new variable combining the <code>fathcoll</code> and <code>mothcoll</code>, into <code>parcoll</code>. This new column indicates if either parent went to college.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"gpa1"</span>)

gpa1<span class="op">$</span>parcoll &lt;-<span class="st"> </span><span class="kw">as.integer</span>(gpa1<span class="op">$</span>fathcoll<span class="op">==</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>gpa1<span class="op">$</span>mothcoll)


GPA_OLS &lt;-<span class="st"> </span><span class="kw">lm</span>(PC <span class="op">~</span><span class="st"> </span>hsGPA <span class="op">+</span><span class="st"> </span>ACT <span class="op">+</span><span class="st"> </span>parcoll, <span class="dt">data =</span> gpa1)</code></pre></div>
<p>Calculate the weights and then pass them to the <code>weights</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weights &lt;-<span class="st"> </span>GPA_OLS<span class="op">$</span>fitted.values <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>GPA_OLS<span class="op">$</span>fitted.values)

GPA_WLS &lt;-<span class="st"> </span><span class="kw">lm</span>(PC <span class="op">~</span><span class="st"> </span>hsGPA <span class="op">+</span><span class="st"> </span>ACT <span class="op">+</span><span class="st"> </span>parcoll, <span class="dt">data =</span> gpa1, <span class="dt">weights =</span> <span class="dv">1</span><span class="op">/</span>weights)</code></pre></div>
<p>Compare the OLS and WLS model in the table below:</p>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
PC
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
hsGPA
</td>
<td>
0.06539 (0.13726)
</td>
<td>
0.03270 (0.12988)
</td>
</tr>
<tr>
<td style="text-align:left">
ACT
</td>
<td>
0.00056 (0.01550)
</td>
<td>
0.00427 (0.01545)
</td>
</tr>
<tr>
<td style="text-align:left">
parcoll
</td>
<td>
0.22105<sup>**</sup> (0.09296)
</td>
<td>
0.21519<sup>**</sup> (0.08629)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.00043 (0.49054)
</td>
<td>
0.02621 (0.47665)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
141
</td>
<td>
141
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.04153
</td>
<td>
0.04644
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.02054
</td>
<td>
0.02556
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 137)
</td>
<td>
0.48599
</td>
<td>
1.01624
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic (df = 3; 137)
</td>
<td>
1.97851
</td>
<td>
2.22404<sup>*</sup>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-9-more-on-specification-and-data-issues" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-9-more-on-specification-and-data-issues" class="anchor"></a>Chapter 9: More on Specification and Data Issues</h2>
<div id="example-9-8-rd-intensity-and-firm-size" class="section level3">
<h3 class="hasAnchor">
<a href="#example-9-8-rd-intensity-and-firm-size" class="anchor"></a><strong><code>Example 9.8:</code> R&amp;D Intensity and Firm Size</strong>
</h3>
<p><span class="math display">\[rdintens = \beta_0 + \beta_1sales + \beta_2profmarg + \mu\]</span></p>
<p>From <em>Businessweek R&amp;D Scoreboard</em>, October 25, 1991. Load the data and estimate the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"rdchem"</span>)

all_rdchem &lt;-<span class="st"> </span><span class="kw">lm</span>(rdintens <span class="op">~</span><span class="st"> </span>sales <span class="op">+</span><span class="st"> </span>profmarg, <span class="dt">data =</span> rdchem)</code></pre></div>
<p>Plotting the data reveals the outlier on the far right of the plot, which will skew the results of our model.</p>
<p><img src="Introductory-Econometrics-Examples_files/figure-html/unnamed-chunk-61-1.png" width="700"></p>
<p>So, we can estimate the model without that data point to gain a better understanding of how <code>sales</code> and <code>profmarg</code> describe <code>rdintens</code> for most firms. We can use the <code>subset</code> argument of the linear model function to indicate that we only want to estimate the model using data that is less than the highest sales.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">smallest_rdchem &lt;-<span class="st"> </span><span class="kw">lm</span>(rdintens <span class="op">~</span><span class="st"> </span>sales <span class="op">+</span><span class="st"> </span>profmarg, <span class="dt">data =</span> rdchem, 
                      <span class="dt">subset =</span> (sales <span class="op">&lt;</span><span class="st"> </span><span class="kw">max</span>(sales)))</code></pre></div>
<p>The table below compares the results of both models side by side. By removing the outlier firm, <span class="math inline">\(sales\)</span> become a more significant determination of R&amp;D expenditures.</p>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
rdintens
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
sales
</td>
<td>
0.00005 (0.00004)
</td>
<td>
0.00019<sup>**</sup> (0.00008)
</td>
</tr>
<tr>
<td style="text-align:left">
profmarg
</td>
<td>
0.04462 (0.04618)
</td>
<td>
0.04784 (0.04448)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.62526<sup>***</sup> (0.58553)
</td>
<td>
2.29685<sup>***</sup> (0.59180)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
32
</td>
<td>
31
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.07612
</td>
<td>
0.17281
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.01240
</td>
<td>
0.11372
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.86205 (df = 29)
</td>
<td>
1.79218 (df = 28)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
1.19465 (df = 2; 29)
</td>
<td>
2.92476<sup>*</sup> (df = 2; 28)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-10-basic-regression-analysis-with-time-series-data" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-10-basic-regression-analysis-with-time-series-data" class="anchor"></a>Chapter 10: Basic Regression Analysis with Time Series Data</h2>
<div id="example-10-2-effects-of-inflation-and-deficits-on-interest-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#example-10-2-effects-of-inflation-and-deficits-on-interest-rates" class="anchor"></a><strong><code>Example 10.2:</code> Effects of Inflation and Deficits on Interest Rates</strong>
</h3>
<p><span class="math display">\[\widehat{i3} = \beta_0 + \beta_1inf_t + \beta_2def_t\]</span> Data from the <em>Economic Report of the President, 2004</em>, Tables B-64, B-73, and B-79.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"intdef"</span>)

tbill_model &lt;-<span class="st"> </span><span class="kw">lm</span>(i3 <span class="op">~</span><span class="st"> </span>inf <span class="op">+</span><span class="st"> </span>def, <span class="dt">data =</span> intdef)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
i3
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
inf
</td>
<td>
0.60587<sup>***</sup> (0.08213)
</td>
</tr>
<tr>
<td style="text-align:left">
def
</td>
<td>
0.51306<sup>***</sup> (0.11838)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
1.73327<sup>***</sup> (0.43197)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
56
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.60207
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.58705
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.84316 (df = 53)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
40.09424<sup>***</sup> (df = 2; 53)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<div id="example-10-11-seasonal-effects-of-antidumping-filings" class="section level3">
<h3 class="hasAnchor">
<a href="#example-10-11-seasonal-effects-of-antidumping-filings" class="anchor"></a><strong><code>Example 10.11:</code> Seasonal Effects of Antidumping Filings</strong>
</h3>
<p>C.M. Krupp and P.S. Pollard (1999), <em>Market Responses to Antidumpting Laws: Some Evidence from the U.S. Chemical Industry</em>, Canadian Journal of Economics 29, 199-227. Dr. Krupp kindly provided the data. They are monthly data covering February 1978 through December 1988.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"barium"</span>)
barium_imports &lt;-<span class="st"> </span><span class="kw">lm</span>(lchnimp <span class="op">~</span><span class="st"> </span>lchempi <span class="op">+</span><span class="st"> </span>lgas <span class="op">+</span><span class="st"> </span>lrtwex <span class="op">+</span><span class="st"> </span>befile6 <span class="op">+</span><span class="st"> </span>affile6 <span class="op">+</span><span class="st"> </span>afdec6, <span class="dt">data =</span> barium)</code></pre></div>
<p>Estimate a new model, <code>barium_seasonal</code> which accounts for seasonality by adding dummy variables contained in the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">barium_seasonal &lt;-<span class="st"> </span><span class="kw">lm</span>(lchnimp <span class="op">~</span><span class="st"> </span>lchempi <span class="op">+</span><span class="st"> </span>lgas <span class="op">+</span><span class="st"> </span>lrtwex <span class="op">+</span><span class="st"> </span>befile6 <span class="op">+</span><span class="st"> </span>affile6 <span class="op">+</span><span class="st"> </span>afdec6 <span class="op">+</span><span class="st"> </span>feb <span class="op">+</span><span class="st"> </span>mar <span class="op">+</span><span class="st"> </span>apr <span class="op">+</span><span class="st"> </span>may <span class="op">+</span><span class="st"> </span>jun <span class="op">+</span><span class="st"> </span>jul <span class="op">+</span><span class="st"> </span>aug <span class="op">+</span><span class="st"> </span>sep <span class="op">+</span><span class="st"> </span>oct <span class="op">+</span><span class="st"> </span>nov <span class="op">+</span><span class="st"> </span>dec, <span class="dt">data =</span> barium)</code></pre></div>
<p>Compare both models:</p>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
lchnimp
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
lchempi
</td>
<td>
3.11719<sup>***</sup> (0.47920)
</td>
<td>
3.26506<sup>***</sup> (0.49293)
</td>
</tr>
<tr>
<td style="text-align:left">
lgas
</td>
<td>
0.19635 (0.90662)
</td>
<td>
-1.27812 (1.38901)
</td>
</tr>
<tr>
<td style="text-align:left">
lrtwex
</td>
<td>
0.98302<sup>**</sup> (0.40015)
</td>
<td>
0.66305 (0.47130)
</td>
</tr>
<tr>
<td style="text-align:left">
befile6
</td>
<td>
0.05957 (0.26097)
</td>
<td>
0.13970 (0.26681)
</td>
</tr>
<tr>
<td style="text-align:left">
affile6
</td>
<td>
-0.03241 (0.26430)
</td>
<td>
0.01263 (0.27869)
</td>
</tr>
<tr>
<td style="text-align:left">
afdec6
</td>
<td>
-0.56524<sup>*</sup> (0.28584)
</td>
<td>
-0.52130<sup>*</sup> (0.30195)
</td>
</tr>
<tr>
<td style="text-align:left">
feb
</td>
<td>
</td>
<td>
-0.41771 (0.30444)
</td>
</tr>
<tr>
<td style="text-align:left">
mar
</td>
<td>
</td>
<td>
0.05905 (0.26473)
</td>
</tr>
<tr>
<td style="text-align:left">
apr
</td>
<td>
</td>
<td>
-0.45148<sup>*</sup> (0.26839)
</td>
</tr>
<tr>
<td style="text-align:left">
may
</td>
<td>
</td>
<td>
0.03331 (0.26924)
</td>
</tr>
<tr>
<td style="text-align:left">
jun
</td>
<td>
</td>
<td>
-0.20633 (0.26925)
</td>
</tr>
<tr>
<td style="text-align:left">
jul
</td>
<td>
</td>
<td>
0.00384 (0.27877)
</td>
</tr>
<tr>
<td style="text-align:left">
aug
</td>
<td>
</td>
<td>
-0.15707 (0.27799)
</td>
</tr>
<tr>
<td style="text-align:left">
sep
</td>
<td>
</td>
<td>
-0.13416 (0.26766)
</td>
</tr>
<tr>
<td style="text-align:left">
oct
</td>
<td>
</td>
<td>
0.05169 (0.26685)
</td>
</tr>
<tr>
<td style="text-align:left">
nov
</td>
<td>
</td>
<td>
-0.24626 (0.26283)
</td>
</tr>
<tr>
<td style="text-align:left">
dec
</td>
<td>
</td>
<td>
0.13284 (0.27142)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-17.80300 (21.04537)
</td>
<td>
16.77877 (32.42865)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
131
</td>
<td>
131
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.30486
</td>
<td>
0.35833
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.27123
</td>
<td>
0.26179
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.59735 (df = 124)
</td>
<td>
0.60121 (df = 113)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
9.06365<sup>***</sup> (df = 6; 124)
</td>
<td>
3.71190<sup>***</sup> (df = 17; 113)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Now, compute the <code>anova</code> between the two models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">barium_anova &lt;-<span class="st"> </span><span class="kw">anova</span>(barium_imports, barium_seasonal)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Res.Df
</td>
<td>
2
</td>
<td>
118.50000
</td>
<td>
7.77817
</td>
<td>
113
</td>
<td>
115.8
</td>
<td>
121.2
</td>
<td>
124
</td>
</tr>
<tr>
<td style="text-align:left">
RSS
</td>
<td>
2
</td>
<td>
42.54549
</td>
<td>
2.40642
</td>
<td>
40.84390
</td>
<td>
41.69469
</td>
<td>
43.39629
</td>
<td>
44.24709
</td>
</tr>
<tr>
<td style="text-align:left">
Df
</td>
<td>
1
</td>
<td>
11.00000
</td>
<td>
</td>
<td>
11.00000
</td>
<td>
11.00000
</td>
<td>
11.00000
</td>
<td>
11.00000
</td>
</tr>
<tr>
<td style="text-align:left">
Sum of Sq
</td>
<td>
1
</td>
<td>
3.40319
</td>
<td>
</td>
<td>
3.40319
</td>
<td>
3.40319
</td>
<td>
3.40319
</td>
<td>
3.40319
</td>
</tr>
<tr>
<td style="text-align:left">
F
</td>
<td>
1
</td>
<td>
0.85594
</td>
<td>
</td>
<td>
0.85594
</td>
<td>
0.85594
</td>
<td>
0.85594
</td>
<td>
0.85594
</td>
</tr>
<tr>
<td style="text-align:left">
Pr(&gt; F)
</td>
<td>
1
</td>
<td>
0.58520
</td>
<td>
</td>
<td>
0.58520
</td>
<td>
0.58520
</td>
<td>
0.58520
</td>
<td>
0.58520
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-11-further-issues-in-using-ols-with-with-time-series-data" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-11-further-issues-in-using-ols-with-with-time-series-data" class="anchor"></a>Chapter 11: Further Issues in Using OLS with with Time Series Data</h2>
<div id="example-11-7-wages-and-productivity" class="section level3">
<h3 class="hasAnchor">
<a href="#example-11-7-wages-and-productivity" class="anchor"></a><strong><code>Example 11.7:</code> Wages and Productivity</strong>
</h3>
<p><span class="math display">\[\widehat{log(hrwage_t)} = \beta_0 + \beta_1log(outphr_t) + \beta_2t + \mu_t\]</span> Data from the <em>Economic Report of the President, 1989</em>, Table B-47. The data are for the non-farm business sector.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"earns"</span>)

wage_time &lt;-<span class="st"> </span><span class="kw">lm</span>(lhrwage <span class="op">~</span><span class="st"> </span>loutphr <span class="op">+</span><span class="st"> </span>t, <span class="dt">data =</span> earns)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wage_diff &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">diff</span>(lhrwage) <span class="op">~</span><span class="st"> </span><span class="kw">diff</span>(loutphr), <span class="dt">data =</span> earns)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lhrwage
</td>
<td>
diff(lhrwage)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
loutphr
</td>
<td>
1.63964<sup>***</sup> (0.09335)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
t
</td>
<td>
-0.01823<sup>***</sup> (0.00175)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
diff(loutphr)
</td>
<td>
</td>
<td>
0.80932<sup>***</sup> (0.17345)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-5.32845<sup>***</sup> (0.37445)
</td>
<td>
-0.00366 (0.00422)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
41
</td>
<td>
40
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.97122
</td>
<td>
0.36424
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.96971
</td>
<td>
0.34750
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 38)
</td>
<td>
0.02854
</td>
<td>
0.01695
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
641.22430<sup>***</sup> (df = 2; 38)
</td>
<td>
21.77054<sup>***</sup> (df = 1; 38)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-12-serial-correlation-and-heteroskedasticiy-in-time-series-regressions" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-12-serial-correlation-and-heteroskedasticiy-in-time-series-regressions" class="anchor"></a>Chapter 12: Serial Correlation and Heteroskedasticiy in Time Series Regressions</h2>
<div id="example-12-4-prais-winsten-estimation-in-the-event-study" class="section level3">
<h3 class="hasAnchor">
<a href="#example-12-4-prais-winsten-estimation-in-the-event-study" class="anchor"></a><strong><code>Example 12.4</code>: Prais-Winsten Estimation in the Event Study</strong>
</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"barium"</span>)

barium_model &lt;-<span class="st"> </span><span class="kw">lm</span>(lchnimp <span class="op">~</span><span class="st"> </span>lchempi <span class="op">+</span><span class="st"> </span>lgas <span class="op">+</span><span class="st"> </span>lrtwex <span class="op">+</span><span class="st"> </span>befile6 <span class="op">+</span><span class="st"> </span>affile6 <span class="op">+</span><span class="st"> </span>afdec6, 
                   <span class="dt">data =</span> barium)</code></pre></div>
<p>Load the <code>prais</code> package, use the <code>prais_winsten</code> function to estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(prais)
barium_prais_winsten &lt;-<span class="st"> </span><span class="kw">prais_winsten</span>(lchnimp <span class="op">~</span><span class="st"> </span>lchempi <span class="op">+</span><span class="st"> </span>lgas <span class="op">+</span><span class="st"> </span>lrtwex <span class="op">+</span><span class="st"> </span>befile6 <span class="op">+</span><span class="st"> </span>affile6 <span class="op">+</span><span class="st"> </span>afdec6, <span class="dt">data =</span> barium)</code></pre></div>
<pre><code>## Iteration 0: rho = 0
## Iteration 1: rho = 0.2708
## Iteration 2: rho = 0.291
## Iteration 3: rho = 0.293
## Iteration 4: rho = 0.2932
## Iteration 5: rho = 0.2932
## Iteration 6: rho = 0.2932
## Iteration 7: rho = 0.2932</code></pre>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lchnimp
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
lchempi
</td>
<td>
3.11719<sup>***</sup> (0.47920)
</td>
</tr>
<tr>
<td style="text-align:left">
lgas
</td>
<td>
0.19635 (0.90662)
</td>
</tr>
<tr>
<td style="text-align:left">
lrtwex
</td>
<td>
0.98302<sup>**</sup> (0.40015)
</td>
</tr>
<tr>
<td style="text-align:left">
befile6
</td>
<td>
0.05957 (0.26097)
</td>
</tr>
<tr>
<td style="text-align:left">
affile6
</td>
<td>
-0.03241 (0.26430)
</td>
</tr>
<tr>
<td style="text-align:left">
afdec6
</td>
<td>
-0.56524<sup>*</sup> (0.28584)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-17.80300 (21.04537)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
131
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.30486
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.27123
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.59735 (df = 124)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
9.06365<sup>***</sup> (df = 6; 124)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">barium_prais_winsten</code></pre></div>
<pre><code>## 
## Call:
## prais_winsten(formula = lchnimp ~ lchempi + lgas + lrtwex + befile6 + 
##     affile6 + afdec6, data = barium)
## 
## Coefficients:
## (Intercept)      lchempi         lgas       lrtwex      befile6  
##   -37.07770      2.94095      1.04638      1.13279     -0.01648  
##     affile6       afdec6  
##    -0.03316     -0.57681  
## 
## AR(1) Coefficient rho: 0.2932</code></pre>

</div>
<div id="example-12-8-heteroskedasticity-and-the-efficient-markets-hypothesis" class="section level3">
<h3 class="hasAnchor">
<a href="#example-12-8-heteroskedasticity-and-the-efficient-markets-hypothesis" class="anchor"></a><strong><code>Example 12.8:</code> Heteroskedasticity and the Efficient Markets Hypothesis</strong>
</h3>
<p>These are Wednesday closing prices of value-weighted NYSE average, available in many publications. Wooldridge does not recall the particular source used when he collected these data at MIT, but notes probably the easiest way to get similar data is to go to the NYSE web site, <a href="https://www.nyse.com/data-and-tech">www.nyse.com</a>.</p>
<p><span class="math display">\[return_t = \beta_0 + \beta_1return_{t-1} + \mu_t\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"nyse"</span>)
?nyse </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">return_AR1 &lt;-<span class="kw">lm</span>(return <span class="op">~</span><span class="st"> </span>return_<span class="dv">1</span>, <span class="dt">data =</span> nyse)</code></pre></div>
<p><span class="math display">\[\hat{\mu^2_t} = \beta_0 + \beta_1return_{t-1} + residual_t\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">return_mu &lt;-<span class="st"> </span><span class="kw">residuals</span>(return_AR1)
mu2_hat_model &lt;-<span class="st"> </span><span class="kw">lm</span>(return_mu<span class="op">^</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>return_<span class="dv">1</span>, <span class="dt">data =</span> return_AR1<span class="op">$</span>model)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
return
</td>
<td>
return_mu2
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
return_1
</td>
<td>
0.05890 (0.03802)
</td>
<td>
-1.10413<sup>***</sup> (0.20140)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.17963<sup>**</sup> (0.08074)
</td>
<td>
4.65650<sup>***</sup> (0.42768)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
689
</td>
<td>
689
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.00348
</td>
<td>
0.04191
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.00203
</td>
<td>
0.04052
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 687)
</td>
<td>
2.11040
</td>
<td>
11.17847
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic (df = 1; 687)
</td>
<td>
2.39946
</td>
<td>
30.05460<sup>***</sup>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<div id="example-12-9-arch-in-stock-returns" class="section level3">
<h3 class="hasAnchor">
<a href="#example-12-9-arch-in-stock-returns" class="anchor"></a><strong><code>Example 12.9:</code> ARCH in Stock Returns</strong>
</h3>
<p><span class="math display">\[\hat{\mu^2_t} = \beta_0 + \hat{\mu^2_{t-1}} + residual_t\]</span></p>
<p>We still have <code>return_mu</code> in the working environment so we can use it to create <span class="math inline">\(\hat{\mu^2_t}\)</span>, (<code>mu2_hat</code>) and <span class="math inline">\(\hat{\mu^2_{t-1}}\)</span> (<code>mu2_hat_1</code>). Notice the use <code>R</code>’s matrix subset operations to perform the lag operation. We drop the first observation of <code>mu2_hat</code> and squared the results. Next, we remove the last observation of <code>mu2_hat_1</code> using the subtraction operator combined with a call to the <code>NROW</code> function on <code>return_mu</code>. Now, both contain <span class="math inline">\(688\)</span> observations and we can estimate a standard linear model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu2_hat  &lt;-<span class="st"> </span>return_mu[<span class="op">-</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>
mu2_hat_<span class="dv">1</span> &lt;-<span class="st"> </span>return_mu[<span class="op">-</span><span class="kw">NROW</span>(return_mu)]<span class="op">^</span><span class="dv">2</span>
arch_model &lt;-<span class="st"> </span><span class="kw">lm</span>(mu2_hat <span class="op">~</span><span class="st"> </span>mu2_hat_<span class="dv">1</span>)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
mu2_hat
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
mu2_hat_1
</td>
<td>
0.33706<sup>***</sup> (0.03595)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.94743<sup>***</sup> (0.44023)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
688
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.11361
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.11231
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
10.75907 (df = 686)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
87.92263<sup>***</sup> (df = 1; 686)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-13-pooling-cross-sections-across-time-simple-panel-data-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-13-pooling-cross-sections-across-time-simple-panel-data-methods" class="anchor"></a>Chapter 13: Pooling Cross Sections across Time: Simple Panel Data Methods</h2>
<div id="example-13-7-effect-of-drunk-driving-laws-on-traffic-fatalities" class="section level3">
<h3 class="hasAnchor">
<a href="#example-13-7-effect-of-drunk-driving-laws-on-traffic-fatalities" class="anchor"></a><strong><code>Example 13.7:</code> Effect of Drunk Driving Laws on Traffic Fatalities</strong>
</h3>
<p>Wooldridge collected these data from two sources, the 1992 <em>Statistical Abstract of the United States</em> (Tables 1009, 1012) and <em>A Digest of State Alcohol-Highway Safety Related Legislation</em>, 1985 and 1990, published by the U.S. National Highway Traffic Safety Administration. <span class="math display">\[\widehat{\Delta{dthrte}} = \beta_0 + \Delta{open} + \Delta{admin}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"traffic1"</span>)
?traffic1</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DD_model &lt;-<span class="st"> </span><span class="kw">lm</span>(cdthrte <span class="op">~</span><span class="st"> </span>copen <span class="op">+</span><span class="st"> </span>cadmn, <span class="dt">data =</span> traffic1)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
cdthrte
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
copen
</td>
<td>
-0.41968<sup>**</sup> (0.20559)
</td>
</tr>
<tr>
<td style="text-align:left">
cadmn
</td>
<td>
-0.15060 (0.11682)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.49679<sup>***</sup> (0.05243)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
51
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.11867
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.08194
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.34350 (df = 48)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
3.23144<sup>**</sup> (df = 2; 48)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-14-advanced-panel-data-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-14-advanced-panel-data-methods" class="anchor"></a>Chapter 14: Advanced Panel Data Methods</h2>
<div id="example-14-1-effect-of-job-training-on-firm-scrap-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#example-14-1-effect-of-job-training-on-firm-scrap-rates" class="anchor"></a><strong><code>Example 14.1:</code> Effect of Job Training on Firm Scrap Rates</strong>
</h3>
<p>In this section, we will estimate a linear panel model using the <code>plm</code> function from the <code>plm: Linear Models for Panel Data</code> package. See the bibliography for more information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plm)
<span class="kw">data</span>(<span class="st">"jtrain"</span>)
scrap_panel &lt;-<span class="st"> </span><span class="kw">plm</span>(lscrap <span class="op">~</span><span class="st"> </span>d88 <span class="op">+</span><span class="st"> </span>d89 <span class="op">+</span><span class="st"> </span>grant <span class="op">+</span><span class="st"> </span>grant_<span class="dv">1</span>, <span class="dt">data =</span> jtrain,
            <span class="dt">index =</span> <span class="kw">c</span>(<span class="st">'fcode'</span>,<span class="st">'year'</span>), <span class="dt">model =</span> <span class="st">'within'</span>, <span class="dt">effect =</span><span class="st">'individual'</span>)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lscrap
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
d88
</td>
<td>
-0.08022 (0.10948)
</td>
</tr>
<tr>
<td style="text-align:left">
d89
</td>
<td>
-0.24720<sup>*</sup> (0.13322)
</td>
</tr>
<tr>
<td style="text-align:left">
grant
</td>
<td>
-0.25231<sup>*</sup> (0.15063)
</td>
</tr>
<tr>
<td style="text-align:left">
grant_1
</td>
<td>
-0.42159<sup>**</sup> (0.21020)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
162
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.20105
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
-0.23684
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
6.54259<sup>***</sup> (df = 4; 104)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-15-instrumental-variables-estimation-and-two-stage-least-squares" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-15-instrumental-variables-estimation-and-two-stage-least-squares" class="anchor"></a>Chapter 15: Instrumental Variables Estimation and Two Stage Least Squares</h2>
<div id="example-15-1-estimating-the-return-to-education-for-married-women" class="section level3">
<h3 class="hasAnchor">
<a href="#example-15-1-estimating-the-return-to-education-for-married-women" class="anchor"></a><strong><code>Example 15.1:</code> Estimating the Return to Education for Married Women</strong>
</h3>
<p>T.A. Mroz (1987), <em>The Sensitivity of an Empirical Model of Married Women’s Hours of Work to Economic and Statistical Assumptions</em>, Econometrica 55, 765-799. Professor Ernst R. Berndt, of MIT, kindly provided the data, which he obtained from Professor Mroz.</p>
<p><span class="math display">\[log(wage) = \beta_0 + \beta_1educ + \mu\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"mroz"</span>)
?mroz</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wage_educ_model &lt;-<span class="st"> </span><span class="kw">lm</span>(lwage <span class="op">~</span><span class="st"> </span>educ, <span class="dt">data =</span> mroz)</code></pre></div>
<p><span class="math display">\[\widehat{educ} = \beta_0 + \beta_1fatheduc\]</span></p>
<p>We run the typical linear model, but notice the use of the <code>subset</code> argument. <code>inlf</code> is a binary variable in which a value of 1 means they are “In the Labor Force”. By sub-setting the <code>mroz</code> data.frame by observations in which <code>inlf==1</code>, only working women will be in the sample.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fatheduc_model &lt;-<span class="st"> </span><span class="kw">lm</span>(educ <span class="op">~</span><span class="st"> </span>fatheduc, <span class="dt">data =</span> mroz, <span class="dt">subset =</span> (inlf<span class="op">==</span><span class="dv">1</span>))</code></pre></div>
<p>In this section, we will perform an <strong>Instrumental-Variable Regression</strong>, using the <code>ivreg</code> function in the <code>AER (Applied Econometrics with R)</code> package. See the bibliography for more information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"AER"</span>)
wage_educ_IV &lt;-<span class="st"> </span><span class="kw">ivreg</span>(lwage <span class="op">~</span><span class="st"> </span>educ <span class="op">|</span><span class="st"> </span>fatheduc, <span class="dt">data =</span> mroz)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lwage
</td>
<td>
educ
</td>
<td>
lwage
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>OLS</em>
</td>
<td>
<em>OLS</em>
</td>
<td>
<em>instrumental</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em></em>
</td>
<td>
<em></em>
</td>
<td>
<em>variable</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
educ
</td>
<td>
0.10865<sup>***</sup> (0.01440)
</td>
<td>
</td>
<td>
0.05917<sup>*</sup> (0.03514)
</td>
</tr>
<tr>
<td style="text-align:left">
fatheduc
</td>
<td>
</td>
<td>
0.26944<sup>***</sup> (0.02859)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.18520 (0.18523)
</td>
<td>
10.23705<sup>***</sup> (0.27594)
</td>
<td>
0.44110 (0.44610)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
428
</td>
<td>
428
</td>
<td>
428
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.11788
</td>
<td>
0.17256
</td>
<td>
0.09344
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.11581
</td>
<td>
0.17062
</td>
<td>
0.09131
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 426)
</td>
<td>
0.68003
</td>
<td>
2.08130
</td>
<td>
0.68939
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic (df = 1; 426)
</td>
<td>
56.92892<sup>***</sup>
</td>
<td>
88.84076<sup>***</sup>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="3" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<div id="example-15-2-estimating-the-return-to-education-for-men" class="section level3">
<h3 class="hasAnchor">
<a href="#example-15-2-estimating-the-return-to-education-for-men" class="anchor"></a><strong><code>Example 15.2:</code> Estimating the Return to Education for Men</strong>
</h3>
<p>Data from M. Blackburn and D. Neumark (1992), <em>Unobserved Ability, Efficiency Wages, and Interindustry Wage Differentials</em>, Quarterly Journal of Economics 107, 1421-1436. Professor Neumark kindly provided the data, of which Wooldridge uses the data for 1980.</p>
<p><span class="math display">\[\widehat{educ} = \beta_0 + sibs\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"wage2"</span>)
?wage2</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">educ_sibs_model &lt;-<span class="st"> </span><span class="kw">lm</span>(educ <span class="op">~</span><span class="st"> </span>sibs, <span class="dt">data =</span> wage2)</code></pre></div>
<p><span class="math display">\[\widehat{log(wage)} = \beta_0 + educ\]</span></p>
<p>Again, estimate the model using the <code>ivreg</code> function in the <code>AER (Applied Econometrics with R)</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"AER"</span>)
educ_sibs_IV &lt;-<span class="st"> </span><span class="kw">ivreg</span>(lwage <span class="op">~</span><span class="st"> </span>educ <span class="op">|</span><span class="st"> </span>sibs, <span class="dt">data =</span> wage2)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
educ
</td>
<td colspan="2">
lwage
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>OLS</em>
</td>
<td colspan="2">
<em>instrumental</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em></em>
</td>
<td colspan="2">
<em>variable</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
sibs
</td>
<td>
-0.22792<sup>***</sup> (0.03028)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
educ
</td>
<td>
</td>
<td>
0.12243<sup>***</sup> (0.02635)
</td>
<td>
0.05917<sup>*</sup> (0.03514)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
14.13879<sup>***</sup> (0.11314)
</td>
<td>
5.13003<sup>***</sup> (0.35517)
</td>
<td>
0.44110 (0.44610)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
935
</td>
<td>
935
</td>
<td>
428
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.05726
</td>
<td>
-0.00917
</td>
<td>
0.09344
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.05625
</td>
<td>
-0.01026
</td>
<td>
0.09131
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
2.13398 (df = 933)
</td>
<td>
0.42330 (df = 933)
</td>
<td>
0.68939 (df = 426)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
56.66715<sup>***</sup> (df = 1; 933)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="3" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<div id="example-15-5-return-to-education-for-working-women" class="section level3">
<h3 class="hasAnchor">
<a href="#example-15-5-return-to-education-for-working-women" class="anchor"></a><strong><code>Example 15.5:</code> Return to Education for Working Women</strong>
</h3>
<p><span class="math display">\[\widehat{log(wage)} = \beta_0 + \beta_1educ + \beta_2exper + \beta_3exper^2\]</span></p>
<p>Use the <code>ivreg</code> function in the <code>AER (Applied Econometrics with R)</code> package to estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"mroz"</span>)
wage_educ_exper_IV &lt;-<span class="st"> </span><span class="kw">ivreg</span>(lwage <span class="op">~</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>exper <span class="op">+</span><span class="st"> </span>expersq <span class="op">|</span><span class="st"> </span>exper <span class="op">+</span><span class="st"> </span>expersq <span class="op">+</span><span class="st"> </span>motheduc <span class="op">+</span><span class="st"> </span>fatheduc, <span class="dt">data =</span> mroz)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
lwage
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
educ
</td>
<td>
0.06140<sup>*</sup> (0.03144)
</td>
</tr>
<tr>
<td style="text-align:left">
exper
</td>
<td>
0.04417<sup>***</sup> (0.01343)
</td>
</tr>
<tr>
<td style="text-align:left">
expersq
</td>
<td>
-0.00090<sup>**</sup> (0.00040)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.04810 (0.40033)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
428
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.13571
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.12959
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.67471 (df = 424)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-16-simultaneous-equations-models" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-16-simultaneous-equations-models" class="anchor"></a>Chapter 16: Simultaneous Equations Models</h2>
<div id="example-16-4-inflation-and-openness" class="section level3">
<h3 class="hasAnchor">
<a href="#example-16-4-inflation-and-openness" class="anchor"></a><strong><code>Example 16.4:</code> INFLATION AND OPENNESS</strong>
</h3>
<p>Data from D. Romer (1993), <em>Openness and Inflation: Theory and Evidence</em>, Quarterly Journal of Economics 108, 869-903. The data are included in the article.</p>
<p><span class="math display">\[inf = \beta_{10} + \alpha_1open + \beta_{11}log(pcinc) + \mu_1\]</span> <span class="math display">\[open = \beta_{20} + \alpha_2inf + \beta_{21}log(pcinc) + \beta_{22}log(land) + \mu_2\]</span></p>
</div>
<div id="example-16-6-inflation-and-openness" class="section level3">
<h3 class="hasAnchor">
<a href="#example-16-6-inflation-and-openness" class="anchor"></a><strong><code>Example 16.6:</code> INFLATION AND OPENNESS</strong>
</h3>
<p><span class="math display">\[\widehat{open} = \beta_0 + \beta_{1}log(pcinc) + \beta_{2}log(land)\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"openness"</span>)
?openness</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">open_model &lt;-<span class="kw">lm</span>(open <span class="op">~</span><span class="st"> </span>lpcinc <span class="op">+</span><span class="st"> </span>lland, <span class="dt">data =</span> openness)</code></pre></div>
<p><span class="math display">\[\widehat{inf} = \beta_0 + \beta_{1}open + \beta_{2}log(pcinc)\]</span></p>
<p>Use the <code>ivreg</code> function in the <code>AER (Applied Econometrics with R)</code> package to estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(AER)
inflation_IV &lt;-<span class="st"> </span><span class="kw">ivreg</span>(inf <span class="op">~</span><span class="st"> </span>open <span class="op">+</span><span class="st"> </span>lpcinc <span class="op">|</span><span class="st"> </span>lpcinc <span class="op">+</span><span class="st"> </span>lland, <span class="dt">data =</span> openness)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
open
</td>
<td>
inf
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>OLS</em>
</td>
<td>
<em>instrumental</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em></em>
</td>
<td>
<em>variable</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
open
</td>
<td>
</td>
<td>
-0.33749<sup>**</sup> (0.14412)
</td>
</tr>
<tr>
<td style="text-align:left">
lpcinc
</td>
<td>
0.54648 (1.49324)
</td>
<td>
0.37582 (2.01508)
</td>
</tr>
<tr>
<td style="text-align:left">
lland
</td>
<td>
-7.56710<sup>***</sup> (0.81422)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
117.08450<sup>***</sup> (15.84830)
</td>
<td>
26.89934<sup>*</sup> (15.40120)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
114
</td>
<td>
114
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.44867
</td>
<td>
0.03088
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.43873
</td>
<td>
0.01341
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 111)
</td>
<td>
17.79559
</td>
<td>
23.83581
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
45.16537<sup>***</sup> (df = 2; 111)
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="chapter-18-advanced-time-series-topics" class="section level2">
<h2 class="hasAnchor">
<a href="#chapter-18-advanced-time-series-topics" class="anchor"></a>Chapter 18: Advanced Time Series Topics</h2>
<div id="example-18-8-forecasting-the-u-s--unemployment-rate" class="section level3">
<h3 class="hasAnchor">
<a href="#example-18-8-forecasting-the-u-s--unemployment-rate" class="anchor"></a><strong><code>Example 18.8:</code> FORECASTING THE U.S. UNEMPLOYMENT RATE</strong>
</h3>
<p>Data from <em>Economic Report of the President, 2004</em>, Tables B-42 and B-64.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"phillips"</span>)
?phillips</code></pre></div>
<p><span class="math display">\[\widehat{unemp_t} = \beta_0 + \beta_1unem_{t-1}\]</span></p>
<p>Estimate the linear model in the usual way and note the use of the <code>subset</code> argument to define data equal to and before the year 1996.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phillips_train &lt;-<span class="st"> </span><span class="kw">subset</span>(phillips, year <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1996</span>)

unem_AR1 &lt;-<span class="st"> </span><span class="kw">lm</span>(unem <span class="op">~</span><span class="st"> </span>unem_<span class="dv">1</span>, <span class="dt">data =</span> phillips_train)</code></pre></div>
<p><span class="math display">\[\widehat{unemp_t} = \beta_0 + \beta_1unem_{t-1} + \beta_2inf_{t-1}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">unem_inf_VAR1 &lt;-<span class="st"> </span><span class="kw">lm</span>(unem <span class="op">~</span><span class="st"> </span>unem_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>inf_<span class="dv">1</span>, <span class="dt">data =</span> phillips_train)</code></pre></div>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
unem
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
unem_1
</td>
<td>
0.73235<sup>***</sup> (0.09689)
</td>
<td>
0.64703<sup>***</sup> (0.08381)
</td>
</tr>
<tr>
<td style="text-align:left">
inf_1
</td>
<td>
</td>
<td>
0.18358<sup>***</sup> (0.04118)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
1.57174<sup>***</sup> (0.57712)
</td>
<td>
1.30380<sup>**</sup> (0.48969)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
48
</td>
<td>
48
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.55397
</td>
<td>
0.69059
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.54427
</td>
<td>
0.67684
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.04857 (df = 46)
</td>
<td>
0.88298 (df = 45)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
57.13184<sup>***</sup> (df = 1; 46)
</td>
<td>
50.21941<sup>***</sup> (df = 2; 45)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Now, use the <code>subset</code> argument to create our testing data set containing observation after 1996. Next, pass the both the model object and the test set to the <code>predict</code> function for both models. Finally, <code>cbind</code> or “column bind” both forecasts as well as the year and unemployment rate of the test set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phillips_test &lt;-<span class="st"> </span><span class="kw">subset</span>(phillips, year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1997</span>)

AR1_forecast &lt;-<span class="st"> </span><span class="kw">predict.lm</span>(unem_AR1, <span class="dt">newdata =</span> phillips_test)
VAR1_forecast &lt;-<span class="st"> </span><span class="kw">predict.lm</span>(unem_inf_VAR1, <span class="dt">newdata =</span> phillips_test)

<span class="kw">kable</span>(<span class="kw">cbind</span>(phillips_test[ ,<span class="kw">c</span>(<span class="st">"year"</span>, <span class="st">"unem"</span>)], AR1_forecast, VAR1_forecast))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">year</th>
<th align="right">unem</th>
<th align="right">AR1_forecast</th>
<th align="right">VAR1_forecast</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>50</td>
<td align="right">1997</td>
<td align="right">4.9</td>
<td align="right">5.526452</td>
<td align="right">5.348468</td>
</tr>
<tr class="even">
<td>51</td>
<td align="right">1998</td>
<td align="right">4.5</td>
<td align="right">5.160275</td>
<td align="right">4.896451</td>
</tr>
<tr class="odd">
<td>52</td>
<td align="right">1999</td>
<td align="right">4.2</td>
<td align="right">4.867333</td>
<td align="right">4.509137</td>
</tr>
<tr class="even">
<td>53</td>
<td align="right">2000</td>
<td align="right">4.0</td>
<td align="right">4.647627</td>
<td align="right">4.425175</td>
</tr>
<tr class="odd">
<td>54</td>
<td align="right">2001</td>
<td align="right">4.8</td>
<td align="right">4.501157</td>
<td align="right">4.516062</td>
</tr>
<tr class="even">
<td>55</td>
<td align="right">2002</td>
<td align="right">5.8</td>
<td align="right">5.087040</td>
<td align="right">4.923537</td>
</tr>
<tr class="odd">
<td>56</td>
<td align="right">2003</td>
<td align="right">6.0</td>
<td align="right">5.819394</td>
<td align="right">5.350271</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="appendix" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix" class="anchor"></a>Appendix</h1>
<div id="using-r-for-introductory-econometrics" class="section level3">
<h3 class="hasAnchor">
<a href="#using-r-for-introductory-econometrics" class="anchor"></a>Using R for Introductory Econometrics</h3>
<p>This is an excellent open source complimentary text to “Introductory Econometrics” by Jeffrey M. Wooldridge and should be your number one resource. This excerpt from the book’s website:</p>
<blockquote>
<p>This book introduces the popular, powerful and free programming language and software package R with a focus on the implementation of standard tools and methods used in econometrics. Unlike other books on similar topics, it does not attempt to provide a self-contained discussion of econometric models and methods. Instead, it builds on the excellent and popular textbook “Introductory Econometrics” by Jeffrey M. Wooldridge.</p>
</blockquote>
<p>Hess, Florian. <em>Using R for Introductory Econometrics</em>. ISBN: 978-1-523-28513-6, CreateSpace Independent Publishing Platform, 2016, Dusseldorf, Germany.</p>
<p><a href="http://www.urfie.net/">url: http://www.urfie.net/</a>.</p>
</div>
<div id="applied-econometrics-with-r" class="section level3">
<h3 class="hasAnchor">
<a href="#applied-econometrics-with-r" class="anchor"></a>Applied Econometrics with R</h3>
<p>From the publisher’s website:</p>
<blockquote>
<p>This is the first book on applied econometrics using the R system for statistical computing and graphics. It presents hands-on examples for a wide range of econometric models, from classical linear regression models for cross-section, time series or panel data and the common non-linear models of microeconometrics such as logit, probit and tobit models, to recent semiparametric extensions. In addition, it provides a chapter on programming, including simulations, optimization, and an introduction to R tools enabling reproducible econometric research. An R package accompanying this book, AER, is available from the Comprehensive R Archive Network (CRAN) at <a href="https://CRAN.R-project.org/package=AER" class="uri">https://CRAN.R-project.org/package=AER</a>.</p>
</blockquote>
<p>Kleiber, Christian and Achim Zeileis. <em>Applied Econometrics with R</em>. ISBN 978-0-387-77316-2, Springer-Verlag, 2008, New York. <a href="https://www.springer.com/us/book/9780387773162" class="uri">https://www.springer.com/us/book/9780387773162</a></p>

</div>
<div id="bibliography" class="section level2">
<h2 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h2>
<p>Croissant Y, Millo G (2008). “Panel Data Econometrics in R: The plm Package.” <em>Journal of Statistical Software</em>, <em>27</em>(2), 1-43. doi: 10.18637/jss.v027.i02 (URL: <a href="http://doi.org/10.18637/jss.v027.i02" class="uri">http://doi.org/10.18637/jss.v027.i02</a>).</p>
<p>Marek Hlavac (2018). <em>stargazer: Well-Formatted Regression and Summary Statistics Tables</em>. R package version 5.2.1. URL: <a href="https://CRAN.R-project.org/package=stargazer" class="uri">https://CRAN.R-project.org/package=stargazer</a></p>
<p>R Core Team (2018). <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing, Vienna, Austria. URL <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
<p>Christian Kleiber and Achim Zeileis (2008). <em>Applied Econometrics with R</em>. New York: Springer-Verlag. ISBN 978-0-387-77316-2. URL: <a href="https://CRAN.R-project.org/package=AER" class="uri">https://CRAN.R-project.org/package=AER</a></p>
<p>Franz X. Mohr (2018). <em>prais: Prais-Winsten Estimator for AR(1) Serial Correlation.</em> R package version 1.0.0. URL: <a href="https://CRAN.R-project.org/package=prais" class="uri">https://CRAN.R-project.org/package=prais</a></p>
<p>R Core Team (2018). <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing, Vienna, Austria. URL: <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
<p>Hadley Wickham. testthat: Get Started with Testing. The R Journal, vol. 3, no. 1, pp. 5–10, 2011. URL: <a href="https://CRAN.R-project.org/package=testthat" class="uri">https://CRAN.R-project.org/package=testthat</a></p>
<p>Jeffrey M. Wooldridge (2016). <em>Introductory Econometrics: A Modern Approach, 6th edition</em>. ISBN-13: 978-1-305-27010-7. Mason, Ohio :South-Western Cengage Learning.</p>
<p>Yihui Xie (2018). <em>knitr: A General-Purpose Package for Dynamic Report Generation in R</em>. R package version 1.20. <a href="https://CRAN.R-project.org/package=knitr" class="uri">https://CRAN.R-project.org/package=knitr</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#chapter-2-the-simple-regression-model">Chapter 2: The Simple Regression Model</a></li>
      <li><a href="#chapter-3-multiple-regression-analysis-estimation">Chapter 3: Multiple Regression Analysis: Estimation</a></li>
      <li><a href="#chapter-4-multiple-regression-analysis-inference">Chapter 4: Multiple Regression Analysis: Inference</a></li>
      <li><a href="#chapter-5-multiple-regression-analysis-ols-asymptotics">Chapter 5: Multiple Regression Analysis: OLS Asymptotics</a></li>
      <li><a href="#chapter-6-multiple-regression-further-issues">Chapter 6: Multiple Regression: Further Issues</a></li>
      <li><a href="#chapter-7-multiple-regression-analysis-with-qualitative-information">Chapter 7: Multiple Regression Analysis with Qualitative Information</a></li>
      <li><a href="#chapter-8-heteroskedasticity">Chapter 8: Heteroskedasticity</a></li>
      <li><a href="#chapter-9-more-on-specification-and-data-issues">Chapter 9: More on Specification and Data Issues</a></li>
      <li><a href="#chapter-10-basic-regression-analysis-with-time-series-data">Chapter 10: Basic Regression Analysis with Time Series Data</a></li>
      <li><a href="#chapter-11-further-issues-in-using-ols-with-with-time-series-data">Chapter 11: Further Issues in Using OLS with with Time Series Data</a></li>
      <li><a href="#chapter-12-serial-correlation-and-heteroskedasticiy-in-time-series-regressions">Chapter 12: Serial Correlation and Heteroskedasticiy in Time Series Regressions</a></li>
      <li><a href="#chapter-13-pooling-cross-sections-across-time-simple-panel-data-methods">Chapter 13: Pooling Cross Sections across Time: Simple Panel Data Methods</a></li>
      <li><a href="#chapter-14-advanced-panel-data-methods">Chapter 14: Advanced Panel Data Methods</a></li>
      <li><a href="#chapter-15-instrumental-variables-estimation-and-two-stage-least-squares">Chapter 15: Instrumental Variables Estimation and Two Stage Least Squares</a></li>
      <li><a href="#chapter-16-simultaneous-equations-models">Chapter 16: Simultaneous Equations Models</a></li>
      <li><a href="#chapter-18-advanced-time-series-topics">Chapter 18: Advanced Time Series Topics</a></li>
      <li>
<a href="#appendix">Appendix</a><ul class="nav nav-pills nav-stacked">
<li><a href="#bibliography">Bibliography</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Justin M. Shea.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
